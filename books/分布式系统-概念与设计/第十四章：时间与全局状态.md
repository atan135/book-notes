本章讲述三个方面：

1. 信息传递近似同步计算机时钟
2. 逻辑时间，根据时序定义事件的顺序
3. 分布式系统中全局状态的使用

## 时钟同步

**时钟偏移：** 两个始终之间的读数的不同，称为时钟偏移

**时钟漂移：** 使用的基于晶体的时钟有不同的时钟漂移率，导致在经过一段时间后，产生可以观察到的时间差异。

#### Berkeley内部同步算法

1. 选择一台协调者计算机作为主机master，定期轮询其他需要同步时钟的计算机slave
2. 从属机将他们的时钟值返回给主机master，主机通过记录往返时间来估计从属机时间
3. 主机master将内部所有机器的时间选择一个容错平均值（去除离平均值太远的数据），将所得结果与每台机器的时间差异分发给对应的从属机
4. 从属机根据差异值修正自己的本地时钟
5. 如果主机故障，另外选举一台新的主机作为master

#### 逻辑时间

基于因果关系排序：

* 如果两个事件发生在同一个进程中，那么他们发生的顺序就是观察到的顺序
* 如果消息在不同进程中发送，发送消息的事件在接收消息的事件之前发生

使用向量时钟处理不同进程之间的时钟同步：

假设需要处理N个进程的时钟同步，每个进程维持一个N维数字数组，这个就是它自己的向量时钟 $$V_i$$ ，用于给本地事件加时间戳。始终更新规则为：

* VC1：初始情况下，$$V_i[j] = 0, 	\quad i,j = 1,2,\ldots, N$$
* VC2：在 $$p_i$$ 给事件加时间戳之前，设置 $$V_i[i] := V_i[i] + 1$$
* VC3：$$p_i$$ 在发送的每个消息中包括自己当前的时间戳 $$t = V_i$$
* VC4：当 $$p_j$$ 接收到消息中的时间戳时，设置 $$V_i[j] = max(V_i[j], t[j]), \quad j = 1,2,\ldots, N$$ 。这个操作称为合并。

全局状态没看了，看不懂。