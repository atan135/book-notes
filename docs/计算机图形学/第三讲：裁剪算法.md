## 裁剪算法

**裁剪：** 使用计算机处理图形信息时，计算机内部存储的图形往往比较大，而屏幕显示的只是其中一部分。因此需要确定哪些部分在显示区域内部，哪些落在屏幕外面，这个过程就是**裁剪**。

直线段裁剪算法是复杂图形裁剪的基础。

常用的裁剪算法：

* **Cohen-Sutherland：**

  又称为编码裁剪算法，对直线段分三种情况处理：

  * p1,p2完全在窗口内，保留
  * p1,p2都在窗口外，且满足以下一条，可以忽略处理
    1. $$x_1 < x_{left}$$ 且 $$x_2 < x_{left}$$
    2. $$x_1 > x_{right}$$ 且 $$x_2 > x_{right}$$
    3. $$y_1 > y_{top}$$ 且 $$y_2 > y_{top}$$
    4. $$y_1 < y_{bottom}$$ 且 $$y_2 < y_{bottom}$$
  * 其余情况，求出端点的编码格式$$D_0D_1D_2D_3$$ ，分别代表大于上边界，小于下边界，右于右边界，左于左边界。这样，如果$$p_0\ |\ p_1 = 0$$ ，那么两点都在窗口内，如果，$$p_0\ \&\ p_1 \ne 0$$ ，那么两点的线段必然在界面外，否则要去求交点。

* **中点分割法：**

  中点分割算法的核心思想是通过二分逼近来确定直线段与窗口的交点。

  * 如果中点不在窗口内，则判断中点与端点的编码是否应该舍弃
  * 如果中点在窗口内，那么继续求中点分别与端点的中点，这样递归逼近，直到中点与边界的坐标值在贵点的误差范围内。

* **Liang-Barsky裁剪算法：**

  * 使用参数方程表示一条直线段：

    ​	$$x = x_1 + u\ \cdot\ (x_2 - x_1) = x_1 + u\ \cdot\ \Delta x$$

    ​	$$y = y_1 + u\ \cdot\ (y_2 - y_1) = y_1 + u\ \cdot\ \Delta y$$

  * 把直线段看作是有方向的线段，把窗口的四条边及其延长线分为两类，入边和出边

    **入边：** 直线由窗口外向窗口内运动时，与窗口及其延长线相交的边

    **出边：** 直线由窗口内向窗口外运动时，与窗口及其延长线相交的边

    用$$u_1,u_2$$ 分别表示线段($$u_1 \le u_2$$)在窗口可见范围的起点和终点所对应的参数，那么

    ​	$$u_1 = \max(0, u_l, u_b)$$

    ​	$$u2 = \min(1, u_t, u_r)$$

    在窗口内的p点需要满足以下条件

    $$\begin{cases} x_{left} \le x_1 + u\ \cdot\ \Delta x \le x_{right} \\ y_{bottom} \le y_1 + u\ \cdot\ \Delta y \le y_{top} \end{cases}$$

    展开可得：

    $$p_1  =  -\Delta x\qquad q_1  =  x_1 - x_{left}$$

    $$p_2 = \Delta x\qquad q_2 = x_{right} - x_1$$

    $$p_3 = -\Delta y\qquad q_3 = y_1 - y_{bottom}$$

    $$p_4 = \Delta y\qquad q_4 = y_{top} - y_1$$

    从而得到$$u_k = \dfrac{q_k}{p_k}$$

    而$$p_k < 0$$ 的值为入边，用于u~1~ 的计算，$$p_k > 0$$ 的为出边，用于u~2~ 的计算，算出来的u值再带入方程，得出裁剪后的两个端点的值

## 多边形裁剪算法

​    多边形裁剪算法的输出应该是裁剪后的多边形边界的顶点的序列，而不是断续的直线裁剪算法得出的结果，因此需要构造一个或多个能产生封闭区域的多边形裁剪算法。

**Sutherland-hogman多边形裁剪：**

​	该算法的基本思想是将多边形边界作为一个整体，每次用窗口的一条边对要裁剪的多边形和中间结果多边形进行裁剪，体现一种分而治之的思想。

​	该算法的不足之处是，只能对凸多边形进行裁剪，但是多凹多边形，会出现冗余线段。

## 文字裁剪

* **串精度裁剪：** 当字符串的所有字符都在裁剪窗口内时，就全部保留，否则舍弃。
* **字符精度裁剪：** 在进行裁剪时，任何与窗口有重叠或者落在边界外的字符，都被裁剪掉。